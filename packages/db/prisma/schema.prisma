generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model token {
  mintAddress          String   @id @unique
  name                 String
  symbol               String
  description          String?
  poolAddress          String   @unique
  graduatedPoolAddress String?  @unique
  website              String?
  isStreamLive         Boolean  @default(false)
  twitter              String?
  telegram             String?
  imageUrl             String?
  metadataUrl          String?
  creatorAddress       String
  bondingCurveProgress Float?
  volume               Float?
  liquidity            Float?
  marketCap            Float?
  holderCount          Int?
  stats5m              Json?
  stats1h              Json?
  stats6h              Json?
  stats24h             Json?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  holders              holder[]
  klines               kline[]
  trades               trade[]
}

model trade {
  id               Int      @id @default(autoincrement())
  type             String
  price            Decimal  @db.Decimal(38, 18)
  tokenAmount      Decimal  @db.Decimal(38, 18)
  solAmount        Decimal  @db.Decimal(38, 18)
  traderAddress    String
  signature        String
  instructionIndex Int?
  timestamp        DateTime
  slot             Int
  tokenMintAddress String
  token            token    @relation(fields: [tokenMintAddress], references: [mintAddress])

  @@unique([signature, tokenMintAddress, instructionIndex])
  @@index([tokenMintAddress, timestamp])
}

model kline {
  timestamp        DateTime
  open             Decimal  @db.Decimal(38, 18)
  high             Decimal  @db.Decimal(38, 18)
  low              Decimal  @db.Decimal(38, 18)
  close            Decimal  @db.Decimal(38, 18)
  volume           Decimal  @db.Decimal(38, 18)
  trades           Int
  tokenMintAddress String
  token            token    @relation(fields: [tokenMintAddress], references: [mintAddress])

  @@id([tokenMintAddress, timestamp])
  @@index([tokenMintAddress, timestamp(sort: Desc)])
}

model holder {
  id               Int      @id @default(autoincrement())
  holderAddress    String
  amount           Decimal  @db.Decimal(38, 18)
  tokenMintAddress String
  token            token    @relation(fields: [tokenMintAddress], references: [mintAddress])

  @@unique([tokenMintAddress, holderAddress])
  @@index([tokenMintAddress])
}
