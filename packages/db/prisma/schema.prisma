// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Token {
  mintAddress          String   @id @unique
  name                 String
  symbol               String
  description          String?
  poolAddress          String   @unique
  graduatedPoolAddress String?  @unique
  website              String?
  twitter              String?
  telegram             String?
  imageUrl             String?
  metadataUrl          String?
  creatorAddress       String
  bondingCurveProgress Float?
  volume               Float?
  liquidity            Float?
  marketCap            Float?
  holderCount          Int?
  stats5m              Json?
  stats1h              Json?
  stats6h              Json?
  stats24h             Json?
  holders              Holder[]
  trades               Trade[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  klines    kline[]
}

model Trade {
  id            Int      @id @default(autoincrement())
  type          String
  price         Float
  tokenAmount   Float
  solAmount     Float
  traderAddress String
  signature     String
  timestamp     DateTime
  slot          Int

  token            Token  @relation(fields: [tokenMintAddress], references: [mintAddress])
  tokenMintAddress String
}

model kline {
  id               Int      @id @default(autoincrement())
  timestamp        DateTime
  open             Float
  high             Float
  low              Float
  close            Float
  volume           Float
  trades           Int
  token            Token    @relation(fields: [tokenMintAddress], references: [mintAddress])
  tokenMintAddress String

  @@unique([tokenMintAddress, timestamp])
}

model Holder {
  id               Int    @id @default(autoincrement())
  holderAddress    String
  amount           Float
  token            Token  @relation(fields: [tokenMintAddress], references: [mintAddress])
  tokenMintAddress String

  @@unique([tokenMintAddress, holderAddress])
}
